<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Магазин товарів</title>
  <style>
    /* Стилі залишаються такими ж як у попередньому варіанті, але додамо нові */
    .image-preview {
      width: 100%;
      height: 200px;
      border: 1px dashed #ccc;
      border-radius: 8px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: #f8f9fa;
    }
    
    .image-preview img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    .product-link {
      display: inline-block;
      margin-top: 15px;
      color: #1976d2;
      text-decoration: none;
      font-weight: 600;
    }
    
    .product-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Наш магазин</h1>

  <!-- Фільтр за категоріями -->
  <div class="filters">
    <label for="categoryFilter"><strong>Оберіть категорію:</strong></label>
    <select id="categoryFilter" onchange="filterProducts()">
      <option value="all">Усі товари</option>
      <option value="jacket">Куртка</option>
      <option value="glasses">Окуляри</option>
      <option value="shoes">Взуття</option>
      <option value="electronics">Електроніка</option>
      <option value="clothing">Одяг</option>
      <option value="home">Дім та побут</option>
    </select>
  </div>

  <!-- Список товарів -->
  <div class="products" id="productsContainer">
    <!-- Товари завантажуються через JS -->
  </div>

  <!-- Адмін панель -->
  <div class="admin-panel">
    <h2>Додати новий товар</h2>
    <form id="productForm">
      <div class="form-group">
        <label for="productName">Назва товару</label>
        <input type="text" id="productName" required placeholder="Наприклад: Шкіряна куртка" />
      </div>

      <div class="form-group">
        <label for="productCategory">Категорія</label>
        <select id="productCategory" required>
          <option value="jacket">Куртка</option>
          <option value="glasses">Окуляри</option>
          <option value="shoes">Взуття</option>
          <option value="electronics">Електроніка</option>
          <option value="clothing">Одяг</option>
          <option value="home">Дім та побут</option>
        </select>
      </div>

      <!-- Завантаження фото через провідник -->
      <div class="form-group">
        <label>Фото товару</label>
        <input type="file" id="productImage" accept="image/*" required />
        <div class="image-preview" id="imagePreview">
          <span>Оберіть зображення</span>
        </div>
      </div>

      <div class="form-group">
        <label for="productPrice">Ціна (грн)</label>
        <input type="number" id="productPrice" step="0.01" min="0" required placeholder="1000" />
      </div>

      <div class="form-group">
        <label for="productDescription">Опис товару</label>
        <textarea id="productDescription" required placeholder="Детальний опис товару..."></textarea>
      </div>

      <div class="form-group">
        <label for="productSpecs">Характеристики</label>
        <textarea id="productSpecs" required placeholder="Матеріал: шкіра, Розмір: M, Колір: чорний"></textarea>
      </div>

      <button type="submit" class="btn">Опублікувати товар</button>
    </form>
  </div>
</div>

<script>
  // Початкові товари
  let products = [
    {
      id: 1,
      name: "Шкіряна куртка",
      category: "jacket",
      image: "https://via.placeholder.com/300x220?text=Шкіряна+куртка",
      price: 2500,
      description: "Стильна шкіряна куртка з натуральної шкіри. Ідеальна для прохолодної погоди.",
      specs: "Матеріал: натуральна шкіра, Розмір: M-L, Колір: чорний"
    },
    {
      id: 2,
      name: "Сонцезахисні окуляри",
      category: "glasses",
      image: "https://via.placeholder.com/300x220?text=Окуляри",
      price: 850,
      description: "Сонцезахисні окуляри з UV-фільтром. Модель 2023 року.",
      specs: "Лінзи: поляризовані, Розмір: універсальний, Колір: чорний/золото"
    },
    {
      id: 3,
      name: "Чоботи зимові",
      category: "shoes",
      image: "https://via.placeholder.com/300x220?text=Чоботи",
      price: 3200,
      description: "Зимові чоботи з теплим утеплювачем. Водонепроникні.",
      specs: "Матеріал: шкіра, Розмір: 38-42, Колір: коричневий"
    }
  ];

  // Показ прев'ю зображення
  document.getElementById('productImage').addEventListener('change', function(e) {
    const preview = document.getElementById('imagePreview');
    const file = e.target.files[0];
    
    if (file) {
      const reader = new FileReader();
      
      reader.onload = function(event) {
        preview.innerHTML = `<img src="${event.target.result}" alt="Попередній перегляд">`;
      };
      
      reader.readAsDataURL(file);
    } else {
      preview.innerHTML = '<span>Оберіть зображення</span>';
    }
  });

  // Зберігання в localStorage
  function saveProducts() {
    localStorage.setItem('google-sites-products', JSON.stringify(products));
  }

  // Завантаження товарів
  function loadProducts() {
    const saved = localStorage.getItem('google-sites-products');
    return saved ? JSON.parse(saved) : products;
  }

  // Відображення товарів
  function renderProducts(productsToRender) {
    const container = document.getElementById('productsContainer');
    container.innerHTML = '';

    productsToRender.forEach(product => {
      const productEl = document.createElement('div');
      productEl.className = 'product';
      productEl.setAttribute('data-category', product.category);

      // Посилання на окрему сторінку товару
      const productPageUrl = `product.html?id=${product.id}`;

      productEl.innerHTML = `
        <img src="${product.image}" alt="${product.name}">
        <div class="product-info">
          <h3>${product.name}</h3>
          <p class="price">${product.price} грн</p>
          <p>${product.description.substring(0, 100)}...</p>
          <a href="${productPageUrl}" class="product-link" target="_blank">Детальніше →</a>
          <div class="specs">
            <strong>Характеристики:</strong><br>
            ${product.specs}
          </div>
          <div class="category-badge">${getCategoryName(product.category)}</div>
        </div>
      `;

      container.appendChild(productEl);
    });
  }

  // Назви категорій
  function getCategoryName(category) {
    const names = {
      'jacket': 'Куртка',
      'glasses': 'Окуляри',
      'shoes': 'Взуття',
      'electronics': 'Електроніка',
      'clothing': 'Одяг',
      'home': 'Дім та побут'
    };
    return names[category] || category;
  }

  // Фільтрація
  function filterProducts() {
    const category = document.getElementById('categoryFilter').value;
    const allProducts = loadProducts();

    if (category === 'all') {
      renderProducts(allProducts);
      return;
    }

    const filtered = allProducts.filter(p => p.category === category);
    renderProducts(filtered);
  }

  // Додавання товару
  document.getElementById('productForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const fileInput = document.getElementById('productImage');
    const file = fileInput.files[0];
    
    if (!file) {
      alert('Будь ласка, оберіть зображення!');
      return;
    }

    const reader = new FileReader();
    
    reader.onload = function(event) {
      const imageDataUrl = event.target.result;
      
      const newProduct = {
        id: Date.now(),
        name: document.getElementById('productName').value,
        category: document.getElementById('productCategory').value,
        image: imageDataUrl,
        price: parseFloat(document.getElementById('productPrice').value),
        description: document.getElementById('productDescription').value,
        specs: document.getElementById('productSpecs').value
      };

      products = loadProducts();
      products.push(newProduct);
      saveProducts();
      
      renderProducts(loadProducts());
      document.getElementById('productForm').reset();
      document.getElementById('imagePreview').innerHTML = '<span>Оберіть зображення</span>';
      
      alert(`✅ Товар успішно додано!\nСторінка товару: ${window.location.origin}/product.html?id=${newProduct.id}`);
    };
    
    reader.readAsDataURL(file);
  });

  // Ініціалізація
  document.addEventListener('DOMContentLoaded', () => {
    if (!localStorage.getItem('google-sites-products')) {
      saveProducts();
    }
    filterProducts();
  });
</script>

</body>
</html>
